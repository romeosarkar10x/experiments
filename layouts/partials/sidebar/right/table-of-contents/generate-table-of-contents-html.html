{{ $headings := .headings }}
{{ $index := .index }}
{{ $level := .level }}

{{ $subsections := partial "sidebar/right/table-of-contents/get-subsections.html" (dict "headings" $headings "level" $level "index" $index) }}
{{ $headingText := replaceRE "^(#{1,6})\\s+(.*)" "$2" (index $headings $index) }}
{{ if eq (len $subsections) 0 }}
    <div class="wrapper"><a href="#heading-{{ $index }}">{{ $headingText }}</a></div>
{{ else }}
    <details>
        <summary
            ><div class="wrapper"
                ><div class="link-wrapper"><a href="#heading-{{ $index }}">{{ $headingText }}</a></div
                ><svg><use href="#sidebar-right-caret"></use></svg></div></summary
        ><ul
            >{{ range $i := $subsections }}
                <li
                    >{{ partial "sidebar/right/table-of-contents/generate-table-of-contents-html.html" (dict "headings" $headings "index" $i "level" (add $level 1)) }}</li
                >
            {{ end }}</ul
        ></details
    >
{{ end }}
